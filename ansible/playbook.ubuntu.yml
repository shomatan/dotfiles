- hosts: localhost
  connection: local
  gather_facts: no
  roles:
    - dotfiles
    - asdf
  vars:
    apt_packages: []
  tasks:
    - name: Add external apt repositories
      apt_repository: repo={{ item }} state=present
      with_items: "{{ apt_repositories|default([]) }}"
      when: item is defined and item != ''

    - name: Update apt-cache
      apt: update_cache=yes

    - name: Install/Upgrade apt packages
      apt: >
        name={{ item.name|default(item) }}
        state={{ item.state|default('latest') }}
      with_items: "{{ apt_packages|default([]) }}"
      when: item is defined and item != ''
